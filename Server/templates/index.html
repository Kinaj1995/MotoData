{% extends 'base.html' %}

{% block head %}




{% endblock %}



{% block body %}

<!-- Insert HTML division tag to layout the map -->
<div id="map"></div>


<!-- Insert Javascript (.js) code to create the map -->
<script src="{{ url_for('static', filename='js/leaflet.js')}}"></script>


{% for file in files %}
<script>
// Read markers data from CSV
$.get("{{ url_for('static', filename='upload/')}}" + "{{file}}", function (csvString) {  

  // Use PapaParse to convert string to array of objects
  var data = Papa.parse(csvString, { header: true, dynamicTyping: true }).data;

  // For each row in data, create a marker and add it to the map
  // For each row, columns `Latitude`, `Longitude`, and `Title` are required
  for (var i in data) {
    var row = data[i];

    var marker = L.marker([row.Latitude, row.Longitude], {
      opacity: 1
    }).bindPopup(row.Title, row.Speed);

    marker.addTo(map);
  }
});
</script>
{% endfor %}


<!-- Modal setMarker Data -->
<div class="modal fade" id="setMarkerModal" tabindex="-1" aria-labelledby="setMarkerModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="setMarkerModalLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <br>
        <p class="lead">Please choose a color.</p>
        <br>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioBlue">
          <label class="form-check-label" for="flexRadioBlue">
            Blue
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioGreen" checked>
          <label class="form-check-label" for="flexRadioGreen">
            Green
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioRed" checked>
          <label class="form-check-label" for="flexRadioRed">
            Red
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>



<!-- Modal Upload Data -->
<div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="uploadModalLabel">Upload Data</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <br>
        <p class="lead">Please upload your CSV-File.</p>
        <br>
        <form action="/upload_data" method="POST" enctype="multipart/form-data">
          <label for="fname">Filename:</label>
          <input type="text" id="fname" name="fname"><label for="csv"> .csv</label><br><br>
          <input type="file" name="file" />
          <br>
          <br>
          <div class="modal-footer">
            <input type="submit" class="btn btn-primary align-left" />
        </form>
      </div>
    </div>
  </div>
</div>





{% endblock %}